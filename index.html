<!DOCTYPE html>
<html lang="zh-CN">
	<head>
        <meta content="text/html;charset=utf-8" http-equiv="content-type"/>
        <title>AnySearch</title>
        <meta name="description" content="">
        <meta name="keywords" content="">
        <link rel="stylesheet" type="text/css" href="style/m-style.css">
        <style id="main-style" type="text/css">
        </style>
	</head>
	<body onload="documentAction()">
        <script src="js/jquery-3.6.0.min.js"></script>
        <script type="text/javascript">
            var coordinateString = '';
            function changeSearchEngine(evt, provider) {
                var i, tabcontent, tablinks;
                tabcontent = document.getElementsByClassName("tabcontent");
                for (i = 0; i < tabcontent.length; i++) {
                    tabcontent[i].style.display = "none";
                }
                tablinks = document.getElementsByClassName("tablinks");
                for (i = 0; i < tablinks.length; i++) {
                    tablinks[i].className = tablinks[i].className.replace(" active", "");
                }
                document.getElementById(provider).style.display = "block";
                evt.currentTarget.className += " active";
            }
            function getGeoLocation() {               
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(showPosition, showError);
                } else {
                    console.log("浏览器不支持定位服务。");
                }
            }
            function showPosition(position) {
                coordinateString = position.coords.longitude + ',' + position.coords.latitude;
            }
            function showError(error) {
                switch(error)
                {
                    case error.PERMISSION_DENIED:
                        console.log("用户禁止使用定位。");
                        break;
                    case error.POSITION_UNAVAILABLE:
                        console.log("位置信息不可用。");
                        break;
                    case error.TIMEOUT:
                        console.log("请求超时。");
                        break;
                    case error.UNKNOWN_ERROR:
                        console.log("未知错误。");
                        break;
                }
            }
            function getWeather() {
                getGeoLocation();
                var we = document.getElementById("weather");
                var ws = document.getElementById("main-style");
                var requestUri = 'https://devapi.qweather.com/v7/weather/now?key=cdeb46a4a56645e3b2425c0f7fb92a8d&location=' + coordinateString;
                $.getJSON(requestUri, function(v) {
                    we.innerHTML = '<img src="img/icons/' + v.now.icon + '.svg" id="weather-icon"/>';
                    we.innerHTML += '' + v.now.temp + '℃';
                });
            }
            function changeBgImage() {
                var day = new Date().getDay();
                var ws = document.getElementById("main-style");
                var we = document.getElementById("weather");
                var coordinateString = '';
                ws.innerHTML += '#top-image { background-image: url("img/bgimg-0' + day + '.webp");'
                    + 'margin-top: 0px;'
                    + 'background-position: center;'
                    + 'background-repeat: no-repeat;'
                    + 'background-attachment: fixed;'
                    + 'width: 100%;'
                    + 'height: 100%; }';
            }
            function applyIFrameStyle() {
                $('#weather-ifm').load(function () {
                    let cssLink = document.createElement("link");
                    cssLink.href = "ifm-style.css";
                    cssLink.rel = "stylesheet";
                    cssLink.type = "text/css";
                    $('#weather-ifm')
                        .contents().find("head")
                        .append($('<link rel="stylesheet" type="text/css" href="ifm-style.css">')
                    );
                });
            }
            function documentAction() {
                changeBgImage();
                applyIFrameStyle();
                //getWeather();
            }
        </script>      
        <!-- 
            https://www.baidu.com/s?wd=
            https://www.google.com/search?q=
            https://www.bing.com/search?q=
            https://zh.wikipedia.org/w/index.php?search=
        -->
        <div id="top-image">
            <div id="top-space"></div>
            <div id="weather" onclick="getWeather()">
                <div>
                    <iframe id="weather-ifm" scrolling="auto" src="https://tianqiapi.com/api.php" frameborder="0">
                    </iframe>
                </div>
            </div>
            <div id="logo-top-space"></div>
            <div id="s-logo">
                <span id="logo"><img id="logo-img" src="img/logo.png" /></span>
            </div>
            <div id="tab-top-space"></div>
            <div id="search-tab">
                <div class="tab">
                    <button class="tablinks" onclick="changeSearchEngine(event, 'Google')">Google</button>
                    <button class="tablinks active" onclick="changeSearchEngine(event, 'Baidu')">Baidu</button>
                    <button class="tablinks" onclick="changeSearchEngine(event, 'Bing')">Bing</button>
                    <button class="tablinks" onclick="changeSearchEngine(event, 'Wikipedia')">Wikipedia</button>
                </div> 
                <div id="search-top-space"></div>
                <div id="Google" class="tabcontent" style="display: none;">
                    <div id="search-box">
                        <form action="https://www.google.com/search" method="get">
                            <input type="text" name="q" placeholder="Google Search" autocomplete="off" />
                            <button id="go" type="submit"></button>
                        </form>
                    </div>
                </div>           
                <div id="Baidu" class="tabcontent" style="display: block;">
                    <div id="search-box">
                        <form action="https://www.baidu.com/s" method="get">
                            <input type="text" name="wd" placeholder="Baidu Search" autocomplete="off" />
                            <button id="go" type="submit"></button>
                        </form>
                    </div>
                </div>            
                <div id="Bing" class="tabcontent" style="display: none;">
                    <div id="search-box">
                        <form action="https://cn.bing.com/search" method="get">
                            <input type="text" name="q" placeholder="Bing Search" autocomplete="off" />
                            <button id="go" type="submit"></button>
                        </form>
                    </div>
                </div>    
                <div id="Wikipedia" class="tabcontent" style="display: none;">
                    <div id="search-box">
                        <form action="https://zh.wikipedia.org/w/index.php" method="get">
                            <input type="text" name="search" placeholder="Wikipedia Search" autocomplete="off" />
                            <button id="go" type="submit"></button>
                        </form>
                    </div>
                </div>
            </div>        
            <div id="rights">
                <p>Copyight &copy; 2022 Carlos, All Rights Reserved.</p>
            </div>
	</body>
</html>
